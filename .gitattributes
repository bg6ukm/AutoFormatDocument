Sub AutoFormatDocument_测试()
    Dim doc As Document
    Dim para As Paragraph
    Dim chineseNumbers As Variant
    chineseNumbers = Array("一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十", "二十一", "二十二", "二十三", "二十四", "二十五", "二十六", "二十七", "二十八", "二十九", "三十", "四十一", "四十二", "四十三", "四十四", "四十五", "四十六", "四十七", "四十八", "四十九", "五十")
    Dim i As Integer
    
    titleSet = False
    paraCount = 0
    
    fzxbs = "方正小标宋_GBK"
    fzht = "方正黑体_GBK"
    fzkt = "方正楷体_GBK"
    fzfs = "方正仿宋_GBK"
    
    ' 获取当前文档
    Set doc = ActiveDocument
    
    ' 清除所有格式
    doc.Content.Select
    Selection.ClearFormatting
    ' 清除页眉页脚
    For Each Section In doc.Sections
        For Each HeaderFooter In Section.Headers
            HeaderFooter.Range.Text = ""
        Next HeaderFooter
        
        For Each HeaderFooter In Section.Footers
            HeaderFooter.Range.Text = ""
        Next HeaderFooter
    Next Section
        
    '设置页边距（上下3.6厘米，左右2.7厘米）
    With doc.PageSetup
      .TopMargin = CentimetersToPoints(3.6)
      .BottomMargin = CentimetersToPoints(3.6)
      .LeftMargin = CentimetersToPoints(2.7)
      .RightMargin = CentimetersToPoints(2.7)
    End With
 
    '设置文档的默认字体和段落格式
    With doc.Content
         .Font.Name = fzfs
         .Font.Size = 16
         .Font.Bold = False
    End With
    With doc.Content.ParagraphFormat
     .LineSpacingRule = wdLineSpaceExactly
     .LineSpacing = 28
     .FirstLineIndent = 32
     .SpaceBefore = 0
     .SpaceAfter = 0
     .Alignment = wdAlignParagraphJustify ' 两端对齐
    End With
  
    ' 遍历文档中的每个段落
    For Each para In doc.Paragraphs
    ' 判断段落是否为标题
        'If Not titleSet Then
        paraCount = paraCount + 1
        If paraCount = 1 Then
            ' 设置标题格式
            With para.Range
            .Font.Name = fzxbs
            .Font.Size = 22
            .Font.Bold = True
            .ParagraphFormat.Alignment = wdAlignParagraphCenter  ' 居中对齐
            End With
            para.Format.FirstLineIndent = 0  '取消首行缩进
            titleSet = True
        ElseIf paraCount = 2 Then
            '设置第二段格式
            With para.Range
            .Font.Name = fzkt
            .Font.Size = 16
            .Font.Bold = True
            .ParagraphFormat.Alignment = wdAlignParagraphCenter  ' 居中对齐
            End With
            para.Format.FirstLineIndent = 0  '取消首行缩进
            
            para.Range.InsertParagraphAfter  '加入一个空白行
        Else
       
            '判断段落是否为一级标题
            'If IsChineseNumber(Left(para.Range.Text, 1)) And Mid(para.Range.Text, 2, 1) = "、" Then
            For i = LBound(chineseNumbers) To UBound(chineseNumbers)
                If para.Range.Text Like chineseNumbers(i) & "、*" Then
                     ' 设置一级标题格式
                     With para.Range
                        .Font.Name = fzht
                        .Font.Size = 16
                        .Font.Bold = True
                     End With
                     Exit For
                End If
            Next i
            'End If
           
            '判断段落是否为二级标题
            'If Left(para.Range.Text, 1) = "（" And IsChineseNumber(Mid(para.Range.Text, 2, 1)) And Mid(para.Range.Text, 3, 1) = "）" Then
            For i = LBound(chineseNumbers) To UBound(chineseNumbers)
                If para.Range.Text Like "（" & chineseNumbers(i) & "）*" Then
                     ' 设置二级标题格式
                     With para.Range
                        .Font.Name = fzkt
                        .Font.Size = 16
                        .Font.Bold = True
                     End With
                     Exit For
                End If
            Next i
            'End If
           
           
            '判断段落是否为三级标题
            'If IsNumeric(Left(para.Range.Text, 1)) And Mid(para.Range.Text, 2, 1) = "." Then
            For i = 1 To 50
                If para.Range.Text Like CStr(i) & ".*" Then
                    ' 设置三级标题格式
                    With para.Range
                        .Font.Name = fzfs
                        .Font.Size = 16
                        .Font.Bold = True
                    End With
                    Exit For
                End If
            Next i
            'End If
            
            '判断段落是否为四级标题
            For i = 1 To 10
                If para.Range.Text Like "（" & CStr(i) & "）*" Then
                    ' 设置四级标题格式
                    With para.Range
                        .Font.Name = fzfs
                        .Font.Size = 16
                        .Font.Bold = True
                    End With
                    Exit For
                End If
            Next i
       
       End If
    Next para
 
 ' 在页脚添加页码
    Dim footer As HeaderFooter
    Set footer = doc.Sections(1).Footers(wdHeaderFooterPrimary)
        'With doc.Sections(1).PageSetup
        '    .DifferentFirstPageHeaderFooter = True
        '    .OddAndEvenPagesHeaderFooter = False
        'End With
        'ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary).PageNumbers.Add FirstPage:=True
        
        With footer.PageNumbers
            .NumberStyle = wdPageNumberStyleNumberInDash    'wdPageNumberStyleNumberInDash 带划线数字样式。
            .RestartNumberingAtSection = True  '不续前节
            .StartingNumber = 1   '从1开始编号
            .Add.Alignment = wdAlignPageNumberOutside  '奇左偶右 .Alignment = wdAlignPageNumberInside
        End With
        
        With footer.Range
            .Font.Name = "宋体" ' 设置字体为宋体
            .Font.Size = 14 ' 设置字号为四号（14磅）
            .Fields.Add Range:=.Duplicate, Type:=wdFieldPage    '屏蔽这行就可以取消奇左偶右，变为居中对齐
        End With
            
    MsgBox "公文排版已完成！"
End Sub